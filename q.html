<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Демо: Браузерные уведомления</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: #333;
        }

        .demo-container {
            max-width: 800px;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .demo-header {
            background: linear-gradient(135deg, #4b6cb7 0%, #182848 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .demo-header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .demo-header p {
            opacity: 0.9;
            font-size: 16px;
        }

        .demo-content {
            padding: 40px;
        }

        .status-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 5px solid #4b6cb7;
        }

        .status-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            margin-top: 10px;
        }

        .status-granted {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-denied {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status-default {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .notification-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .notification-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .notification-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .notification-card.info {
            border-color: #3498db;
        }

        .notification-card.success {
            border-color: #2ecc71;
        }

        .notification-card.warning {
            border-color: #f39c12;
        }

        .notification-card.error {
            border-color: #e74c3c;
        }

        .notification-icon {
            font-size: 40px;
            margin-bottom: 15px;
        }

        .notification-card.info .notification-icon {
            color: #3498db;
        }

        .notification-card.success .notification-icon {
            color: #2ecc71;
        }

        .notification-card.warning .notification-icon {
            color: #f39c12;
        }

        .notification-card.error .notification-icon {
            color: #e74c3c;
        }

        .notification-card h4 {
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .notification-card p {
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .test-btn {
            background: linear-gradient(135deg, #4b6cb7 0%, #182848 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .test-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(76, 108, 183, 0.4);
        }

        .demo-footer {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            border-top: 1px solid #e9ecef;
            color: #6c757d;
            font-size: 14px;
        }

        .notification-request {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 20px;
            max-width: 350px;
            z-index: 1000;
            animation: slideIn 0.5s ease-out;
            border-left: 5px solid #4b6cb7;
        }

        .notification-request.hidden {
            display: none;
        }

        .request-content {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .request-icon {
            font-size: 24px;
            color: #4b6cb7;
        }

        .request-text {
            flex: 1;
        }

        .request-text strong {
            display: block;
            margin-bottom: 5px;
            color: #2c3e50;
        }

        .request-text p {
            color: #7f8c8d;
            font-size: 14px;
            margin: 0;
        }

        .request-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .allow-btn {
            background: #4b6cb7;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            flex: 1;
            transition: background 0.3s;
        }

        .allow-btn:hover {
            background: #182848;
        }

        .deny-btn {
            background: #e9ecef;
            color: #6c757d;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            flex: 1;
            transition: background 0.3s;
        }

        .deny-btn:hover {
            background: #dee2e6;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .custom-notification {
            margin-top: 30px;
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .custom-notification h3 {
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: #4b6cb7;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-row .form-group {
            flex: 1;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateY(0);
                opacity: 1;
            }
            to {
                transform: translateY(-100%);
                opacity: 0;
            }
        }

        .demo-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            display: none;
            align-items: center;
            gap: 15px;
            z-index: 1001;
            max-width: 400px;
            animation: slideIn 0.3s ease-out;
            border-left: 4px solid #4b6cb7;
        }

        .demo-notification.show {
            display: flex;
        }

        .demo-notification.success {
            border-left-color: #2ecc71;
        }

        .demo-notification.error {
            border-left-color: #e74c3c;
        }

        .demo-notification.warning {
            border-left-color: #f39c12;
        }

        .demo-notification.info {
            border-left-color: #3498db;
        }

        .demo-notification .icon {
            font-size: 24px;
        }

        .demo-notification.success .icon {
            color: #2ecc71;
        }

        .demo-notification.error .icon {
            color: #e74c3c;
        }

        .demo-notification.warning .icon {
            color: #f39c12;
        }

        .demo-notification.info .icon {
            color: #3498db;
        }

        .demo-notification .text {
            flex: 1;
        }

        .demo-notification .text h4 {
            margin-bottom: 5px;
            color: #2c3e50;
        }

        .demo-notification .text p {
            color: #7f8c8d;
            font-size: 14px;
            margin: 0;
        }

        .demo-notification .close {
            background: none;
            border: none;
            color: #95a5a6;
            cursor: pointer;
            font-size: 18px;
        }

        @media (max-width: 768px) {
            .demo-content {
                padding: 20px;
            }

            .notification-types {
                grid-template-columns: 1fr;
            }

            .notification-request {
                left: 20px;
                right: 20px;
                max-width: none;
            }

            .form-row {
                flex-direction: column;
                gap: 0;
            }

            .demo-notification {
                left: 20px;
                right: 20px;
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="demo-header">
            <h1><i class="fas fa-bell"></i> Демо: Браузерные уведомления</h1>
            <p>Тестирование системы уведомлений в реальном времени</p>
        </div>

        <div class="demo-content">
            <div class="status-card">
                <h3><i class="fas fa-info-circle"></i> Статус уведомлений</h3>
                <p>Текущее состояние разрешений браузера на показ уведомлений:</p>
                <div class="status-indicator" id="statusIndicator">
                    <i class="fas fa-question-circle"></i>
                    <span id="statusText">Проверка...</span>
                </div>
                <div class="controls">
                    <button class="test-btn" id="checkPermission">
                        <i class="fas fa-sync-alt"></i> Проверить статус
                    </button>
                    <button class="test-btn" id="requestPermission">
                        <i class="fas fa-hand-paper"></i> Запросить разрешение
                    </button>
                </div>
            </div>

            <h3 style="color: #2c3e50; margin-bottom: 20px; text-align: center;">
                <i class="fas fa-flask"></i> Тестовые уведомления
            </h3>

            <div class="notification-types">
                <div class="notification-card info" data-type="info">
                    <div class="notification-icon">
                        <i class="fas fa-info-circle"></i>
                    </div>
                    <h4>Информация</h4>
                    <p>Обычное информационное уведомление</p>
                    <button class="test-btn test-notification" data-type="info">
                        <i class="fas fa-bell"></i> Тест
                    </button>
                </div>

                <div class="notification-card success" data-type="success">
                    <div class="notification-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h4>Успех</h4>
                    <p>Уведомление об успешном действии</p>
                    <button class="test-btn test-notification" data-type="success">
                        <i class="fas fa-bell"></i> Тест
                    </button>
                </div>

                <div class="notification-card warning" data-type="warning">
                    <div class="notification-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <h4>Предупреждение</h4>
                    <p>Уведомление-предупреждение</p>
                    <button class="test-btn test-notification" data-type="warning">
                        <i class="fas fa-bell"></i> Тест
                    </button>
                </div>

                <div class="notification-card error" data-type="error">
                    <div class="notification-icon">
                        <i class="fas fa-times-circle"></i>
                    </div>
                    <h4>Ошибка</h4>
                    <p>Уведомление об ошибке</p>
                    <button class="test-btn test-notification" data-type="error">
                        <i class="fas fa-bell"></i> Тест
                    </button>
                </div>
            </div>

            <div class="custom-notification">
                <h3><i class="fas fa-sliders-h"></i> Кастомное уведомление</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="notificationTitle"><i class="fas fa-heading"></i> Заголовок</label>
                        <input type="text" id="notificationTitle" class="form-control" 
                               placeholder="Введите заголовок" value="Новое уведомление">
                    </div>
                    <div class="form-group">
                        <label for="notificationType"><i class="fas fa-tag"></i> Тип</label>
                        <select id="notificationType" class="form-control">
                            <option value="info">Информация</option>
                            <option value="success">Успех</option>
                            <option value="warning">Предупреждение</option>
                            <option value="error">Ошибка</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="notificationBody"><i class="fas fa-align-left"></i> Текст уведомления</label>
                    <textarea id="notificationBody" class="form-control" rows="3" 
                              placeholder="Введите текст уведомления">Это тестовое уведомление от демо-страницы. Нажмите на него, чтобы перейти на эту страницу.</textarea>
                </div>
                <div class="form-group">
                    <label for="notificationIcon"><i class="fas fa-image"></i> Иконка (опционально)</label>
                    <input type="text" id="notificationIcon" class="form-control" 
                           placeholder="URL иконки или оставьте пустым для стандартной">
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="requireInteraction" checked>
                        <i class="fas fa-hand-pointer"></i> Требует взаимодействия
                    </label>
                    <label style="margin-left: 20px;">
                        <input type="checkbox" id="playSound">
                        <i class="fas fa-volume-up"></i> Звук уведомления
                    </label>
                </div>
                <div style="text-align: center;">
                    <button class="test-btn" id="sendCustomNotification" style="padding: 15px 30px;">
                        <i class="fas fa-paper-plane"></i> Отправить кастомное уведомление
                    </button>
                </div>
            </div>

            <div class="status-card" style="margin-top: 30px;">
                <h3><i class="fas fa-question-circle"></i> Инструкция</h3>
                <p><strong>Как это работает:</strong></p>
                <ul style="padding-left: 20px; margin-top: 10px; line-height: 1.6;">
                    <li>Нажмите "Запросить разрешение" для доступа к уведомлениям</li>
                    <li>Браузер запросит разрешение (обычно вверху страницы)</li>
                    <li>После разрешения используйте кнопки "Тест" для отправки уведомлений</li>
                    <li>Уведомления будут появляться даже если страница неактивна</li>
                    <li>Нажмите на уведомление, чтобы перейти на эту страницу</li>
                </ul>
                <p style="margin-top: 15px; color: #e74c3c; font-weight: 600;">
                    <i class="fas fa-exclamation-triangle"></i> Важно: Для работы уведомлений нужен HTTPS или localhost
                </p>
            </div>
        </div>

        <div class="demo-footer">
            <p><i class="far fa-copyright"></i> Демонстрация браузерных уведомлений | Используется Notification API</p>
            <p style="margin-top: 5px; font-size: 12px;">
                Совместимо с Chrome, Firefox, Edge, Safari 15+
            </p>
        </div>
    </div>

    <!-- Окно запроса разрешения -->
    <div class="notification-request hidden" id="permissionRequest">
        <div class="request-content">
            <div class="request-icon">
                <i class="fas fa-bell"></i>
            </div>
            <div class="request-text">
                <strong>Разрешить уведомления?</strong>
                <p>Чтобы получать тестовые уведомления, разрешите их показ в браузере</p>
            </div>
        </div>
        <div class="request-buttons">
            <button class="allow-btn" id="allowNotifications">Разрешить</button>
            <button class="deny-btn" id="denyNotifications">Не сейчас</button>
        </div>
    </div>

    <!-- Демо-уведомление в интерфейсе -->
    <div class="demo-notification" id="demoNotification">
        <div class="icon">
            <i class="fas fa-info-circle"></i>
        </div>
        <div class="text">
            <h4 id="demoNotificationTitle">Заголовок</h4>
            <p id="demoNotificationBody">Текст уведомления</p>
        </div>
        <button class="close" id="closeDemoNotification">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <script>
        // Элементы DOM
        const statusIndicator = document.getElementById('statusIndicator');
        const statusText = document.getElementById('statusText');
        const checkPermissionBtn = document.getElementById('checkPermission');
        const requestPermissionBtn = document.getElementById('requestPermission');
        const testNotificationBtns = document.querySelectorAll('.test-notification');
        const sendCustomNotificationBtn = document.getElementById('sendCustomNotification');
        const permissionRequest = document.getElementById('permissionRequest');
        const allowNotificationsBtn = document.getElementById('allowNotifications');
        const denyNotificationsBtn = document.getElementById('denyNotifications');
        const demoNotification = document.getElementById('demoNotification');
        const demoNotificationTitle = document.getElementById('demoNotificationTitle');
        const demoNotificationBody = document.getElementById('demoNotificationBody');
        const closeDemoNotificationBtn = document.getElementById('closeDemoNotification');

        // Обновление статуса разрешений
        function updatePermissionStatus() {
            if (!('Notification' in window)) {
                statusIndicator.className = 'status-indicator status-denied';
                statusText.innerHTML = '<i class="fas fa-times-circle"></i> Браузер не поддерживает уведомления';
                requestPermissionBtn.disabled = true;
                return;
            }

            switch(Notification.permission) {
                case 'granted':
                    statusIndicator.className = 'status-indicator status-granted';
                    statusText.innerHTML = '<i class="fas fa-check-circle"></i> Разрешено';
                    requestPermissionBtn.innerHTML = '<i class="fas fa-check"></i> Уже разрешено';
                    requestPermissionBtn.disabled = true;
                    permissionRequest.classList.add('hidden');
                    break;
                case 'denied':
                    statusIndicator.className = 'status-indicator status-denied';
                    statusText.innerHTML = '<i class="fas fa-ban"></i> Запрещено';
                    requestPermissionBtn.innerHTML = '<i class="fas fa-hand-paper"></i> Запрещено пользователем';
                    requestPermissionBtn.disabled = true;
                    permissionRequest.classList.add('hidden');
                    break;
                default:
                    statusIndicator.className = 'status-indicator status-default';
                    statusText.innerHTML = '<i class="fas fa-question-circle"></i> Не запрошено';
                    requestPermissionBtn.innerHTML = '<i class="fas fa-hand-paper"></i> Запросить разрешение';
                    requestPermissionBtn.disabled = false;
                    // Показываем запрос через 2 секунды
                    setTimeout(() => {
                        if (Notification.permission === 'default') {
                            permissionRequest.classList.remove('hidden');
                        }
                    }, 2000);
                    break;
            }
        }

        // Запрос разрешения
        async function requestPermission() {
            if (!('Notification' in window)) {
                showDemoNotification('Ошибка', 'Браузер не поддерживает уведомления', 'error');
                return;
            }

            try {
                const permission = await Notification.requestPermission();
                updatePermissionStatus();
                
                if (permission === 'granted') {
                    showDemoNotification('Успех!', 'Разрешение на уведомления получено', 'success');
                    permissionRequest.classList.add('hidden');
                    
                    // Отправляем тестовое уведомление
                    setTimeout(() => {
                        sendBrowserNotification('Добро пожаловать!', 
                            'Теперь вы будете получать уведомления с этой страницы', 'success');
                    }, 1000);
                } else {
                    showDemoNotification('Предупреждение', 'Уведомления не разрешены', 'warning');
                }
            } catch (error) {
                console.error('Ошибка запроса разрешения:', error);
                showDemoNotification('Ошибка', 'Не удалось запросить разрешение', 'error');
            }
        }

        // Отправка браузерного уведомления
        function sendBrowserNotification(title, body, type = 'info', icon = null, requireInteraction = true) {
            if (Notification.permission !== 'granted') {
                showDemoNotification('Ошибка', 'Сначала разрешите уведомления', 'error');
                return;
            }

            // Определяем иконку по типу
            let notificationIcon = icon;
            if (!notificationIcon) {
                switch(type) {
                    case 'success':
                        notificationIcon = 'data:image/svg+xml;base64,' + btoa(`
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#2ecc71">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                            </svg>
                        `);
                        break;
                    case 'error':
                        notificationIcon = 'data:image/svg+xml;base64,' + btoa(`
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#e74c3c">
                                <path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"/>
                            </svg>
                        `);
                        break;
                    case 'warning':
                        notificationIcon = 'data:image/svg+xml;base64,' + btoa(`
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#f39c12">
                                <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/>
                            </svg>
                        `);
                        break;
                    default:
                        notificationIcon = 'data:image/svg+xml;base64,' + btoa(`
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#3498db">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/>
                            </svg>
                        `);
                }
            }

            // Параметры уведомления
            const options = {
                body: body,
                icon: notificationIcon,
                badge: 'data:image/svg+xml;base64,' + btoa(`
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
                        <circle cx="24" cy="24" r="24" fill="#4b6cb7"/>
                    </svg>
                `),
                tag: `demo-${Date.now()}`,
                renotify: true,
                requireInteraction: requireInteraction,
                silent: !document.getElementById('playSound').checked
            };

            // Добавляем действия если поддерживается
            if ('actions' in Notification.prototype) {
                options.actions = [
                    {
                        action: 'open',
                        title: 'Открыть'
                    },
                    {
                        action: 'close',
                        title: 'Закрыть'
                    }
                ];
            }

            try {
                const notification = new Notification(title, options);

                // Обработчик клика
                notification.onclick = function(event) {
                    event.preventDefault();
                    window.focus();
                    notification.close();
                    
                    // Показываем подтверждение в интерфейсе
                    showDemoNotification('Клик по уведомлению', 
                        'Вы нажали на браузерное уведомление', 'success');
                };

                // Обработчик действий (если поддерживается)
                notification.onaction = function(event) {
                    if (event.action === 'open') {
                        window.focus();
                    }
                    notification.close();
                };

                // Автоматическое закрытие через 15 секунд
                setTimeout(() => {
                    notification.close();
                }, 15000);

                // Воспроизведение звука (если включено)
                if (document.getElementById('playSound').checked) {
                    playNotificationSound();
                }

            } catch (error) {
                console.error('Ошибка создания уведомления:', error);
                showDemoNotification('Ошибка', 'Не удалось создать уведомление', 'error');
            }
        }

        // Показать демо-уведомление в интерфейсе
        function showDemoNotification(title, body, type = 'info') {
            demoNotificationTitle.textContent = title;
            demoNotificationBody.textContent = body;
            
            // Устанавливаем класс типа
            demoNotification.className = 'demo-notification show';
            demoNotification.classList.add(type);
            
            // Устанавливаем иконку
            const icon = demoNotification.querySelector('.icon i');
            switch(type) {
                case 'success':
                    icon.className = 'fas fa-check-circle';
                    break;
                case 'error':
                    icon.className = 'fas fa-times-circle';
                    break;
                case 'warning':
                    icon.className = 'fas fa-exclamation-triangle';
                    break;
                default:
                    icon.className = 'fas fa-info-circle';
            }
            
            // Автоматическое скрытие через 5 секунд
            setTimeout(() => {
                demoNotification.classList.remove('show');
            }, 5000);
        }

        // Воспроизведение звука уведомления
        function playNotificationSound() {
            try {
                // Создаем простой звук через Web Audio API
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // Разные частоты для разных типов
                let frequency = 800;
                switch(document.getElementById('notificationType').value) {
                    case 'success': frequency = 1000; break;
                    case 'error': frequency = 600; break;
                    case 'warning': frequency = 800; break;
                    default: frequency = 900;
                }
                
                oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.3);
                
            } catch (error) {
                // Fallback на HTML5 Audio
                const audio = new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA==');
                audio.volume = 0.3;
                audio.play().catch(() => {
                    // Игнорируем ошибки воспроизведения звука
                });
            }
        }

        // Инициализация
        document.addEventListener('DOMContentLoaded', function() {
            // Проверяем поддержку
            if (!('Notification' in window)) {
                showDemoNotification('Предупреждение', 
                    'Ваш браузер не поддерживает уведомления', 'warning');
            }
            
            // Обновляем статус
            updatePermissionStatus();
            
            // Обработчики событий
            checkPermissionBtn.addEventListener('click', updatePermissionStatus);
            requestPermissionBtn.addEventListener('click', requestPermission);
            
            // Тестовые уведомления
            testNotificationBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const type = this.closest('.notification-card').dataset.type;
                    let title, body;
                    
                    switch(type) {
                        case 'success':
                            title = 'Успешная операция';
                            body = 'Тестовое уведомление об успешном действии';
                            break;
                        case 'warning':
                            title = 'Предупреждение';
                            body = 'Это тестовое предупреждение';
                            break;
                        case 'error':
                            title = 'Ошибка';
                            body = 'Тестовое уведомление об ошибке';
                            break;
                        default:
                            title = 'Информация';
                            body = 'Тестовое информационное уведомление';
                    }
                    
                    sendBrowserNotification(title, body, type);
                    showDemoNotification('Отправлено', 
                        `Тестовое уведомление (${type}) отправлено`, 'info');
                });
            });
            
            // Кастомное уведомление
            sendCustomNotificationBtn.addEventListener('click', function() {
                const title = document.getElementById('notificationTitle').value || 'Без заголовка';
                const body = document.getElementById('notificationBody').value || 'Без текста';
                const type = document.getElementById('notificationType').value;
                const icon = document.getElementById('notificationIcon').value || null;
                const requireInteraction = document.getElementById('requireInteraction').checked;
                
                sendBrowserNotification(title, body, type, icon, requireInteraction);
                showDemoNotification('Отправлено', 'Кастомное уведомление отправлено', 'info');
            });
            
            // Запрос разрешения
            allowNotificationsBtn.addEventListener('click', requestPermission);
            denyNotificationsBtn.addEventListener('click', function() {
                permissionRequest.classList.add('hidden');
                showDemoNotification('Понятно', 
                    'Вы можете запросить разрешение позже', 'info');
            });
            
            // Закрытие демо-уведомления
            closeDemoNotificationBtn.addEventListener('click', function() {
                demoNotification.classList.remove('show');
            });
            
            // Показываем приветственное сообщение
            setTimeout(() => {
                showDemoNotification('Добро пожаловать!', 
                    'Используйте кнопки ниже для тестирования уведомлений', 'info');
            }, 1000);
            
            // Проверяем разрешение каждые 10 секунд (на случай изменения в другом месте)
            setInterval(updatePermissionStatus, 10000);
        });
    </script>
</body>
</html>